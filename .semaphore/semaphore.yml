version: v1.0
name: Apple/Mojave Based Pipeline
agent:
  machine:
    type: a1-standard-4
    os_image: macos-mojave-xcode11
blocks:
  - name: macOS Setup
    task:
      jobs:
        - name: pre_build_setup
          commands:
            - cache restore
            - brew install make
            - brew install gcc
            - brew install gtk+3
            - brew install gtkmm3
            - brew install cairomm
            - cache store
  - name: macOS Builds
    task:
      jobs:
        - name: calculator_simple
          commands:
            - checkout
            - cache restore
            - brew list
            - ls -alF
            - cd ./calculator_simple/build/macos/
            - gmake
        - name: test_install
          commands:
            - checkout
            - cache restore
            - brew list
            - ls -alF
            - cd ./calculator_simple/build/macos/
            - gmake
